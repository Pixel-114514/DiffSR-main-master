2025-10-07 08:39:32 - [INFO] - Loading dataset: NavierStokes2D
Loading processed data from  /home/yc/CVPR_26_fluid_SR/DiffSR-main-master1/DiffSR-main-master/NavierStokes_V1e-5_N1200_T20_processed.pt
2025-10-07 08:39:32 - [INFO] - Dataset loading completed in 0.07s
2025-10-07 08:39:32 - [INFO] - Building model trainer: FNO2d
2025-10-07 08:39:32 - [INFO] - Trainer initialized. Distributed mode: True
2025-10-07 08:39:32 - [INFO] - Device: cuda:0
2025-10-07 08:39:32 - [INFO] - Full configuration loaded.
2025-10-07 08:39:32 - [INFO] - FNO2DTrainer 已初始化。
2025-10-07 08:39:32 - [INFO] - 正在使用以下参数构建 FNO2d 模型: {'modes1': [15, 12, 9, 9, 9], 'modes2': [15, 12, 9, 9, 9], 'width': 64, 'fc_dim': 128, 'layers': [16, 24, 24, 32, 32], 'in_dim': 3, 'out_dim': 1, 'act': 'gelu', 'upsample_factor': [2, 2]}
2025-10-07 08:39:32 - [INFO] - Model architecture:
FNO2d(
  (fc0): Linear(in_features=3, out_features=16, bias=True)
  (sp_convs): ModuleList(
    (0-3): 4 x SpectralConv2d()
  )
  (ws): ModuleList(
    (0): Conv1d(16, 24, kernel_size=(1,), stride=(1,))
    (1): Conv1d(24, 24, kernel_size=(1,), stride=(1,))
    (2): Conv1d(24, 32, kernel_size=(1,), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1,), stride=(1,))
  )
  (up_sp_conv): SpectralUpsampleConv2d()
  (up_ws): ConvTranspose2d(16, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), output_padding=(1, 1))
  (fc1): Linear(in_features=32, out_features=128, bias=True)
  (fc2): Linear(in_features=128, out_features=32, bias=True)
  (fc3): Linear(in_features=32, out_features=1, bias=True)
)
2025-10-07 08:39:32 - [INFO] - Optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.002
    lr: 0.002
    maximize: False
    weight_decay: 0.001
)
2025-10-07 08:39:32 - [INFO] - Scheduler: <torch.optim.lr_scheduler.StepLR object at 0x7f37e439ef50>
2025-10-07 08:39:32 - [INFO] - Criterion: <utils.loss.LpLoss object at 0x7f37e439f1c0>
2025-10-07 08:39:32 - [INFO] - Model and trainer setup completed in 0.06s
2025-10-07 08:39:32 - [INFO] - Starting training process...
2025-10-07 08:39:32 - [INFO] - Starting training...
2025-10-07 08:39:32 - [INFO] - Train dataset size: 1920
2025-10-07 08:39:32 - [INFO] - Valid dataset size: 240
2025-10-07 08:39:32 - [INFO] - Test dataset size: 220
2025-10-07 08:39:33 - [INFO] - Epoch 0/39 | train_loss: 1.00812453 | Time: 1.39s | lr: 0.002000
2025-10-07 08:39:34 - [INFO] - Epoch 1/39 | train_loss: 1.00040547 | Time: 0.69s | lr: 0.002000
2025-10-07 08:39:35 - [INFO] - Epoch 2/39 | train_loss: 0.98303186 | Time: 0.67s | lr: 0.002000
2025-10-07 08:39:35 - [INFO] - Epoch 3/39 | train_loss: 0.76829063 | Time: 0.68s | lr: 0.002000
2025-10-07 08:39:36 - [INFO] - Epoch 4/39 | train_loss: 0.47238149 | Time: 0.71s | lr: 0.002000
2025-10-07 08:39:36 - [INFO] - Visualizing sample at epoch 4 to logs/NavierStokes2D/20251007_083536_FNO2d/visualization/epoch_0004
2025-10-07 08:39:36 - [ERROR] - An error occurred during the training procedure on rank 0: The size of tensor a (1024) must match the size of tensor b (4096) at non-singleton dimension 1
Traceback (most recent call last):
  File "/home/yc/CVPR_26_fluid_SR/DiffSR-main-master1/DiffSR-main-master/main.py", line 90, in main
    ns2d_procedure(config)
  File "/home/yc/CVPR_26_fluid_SR/DiffSR-main-master1/DiffSR-main-master/procedures/ns2d.py", line 88, in ns2d_procedure
    trainer.process(
  File "/home/yc/CVPR_26_fluid_SR/DiffSR-main-master1/DiffSR-main-master/trainers/base.py", line 324, in process
    valid_loss = self.evaluate(model_to_eval, valid_loader, criterion, metrics, split="valid",visualize=visualize,visual_interval=visual_interval,epoch=epoch,**kwargs)
  File "/home/yc/miniconda3/envs/IFact/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/yc/CVPR_26_fluid_SR/DiffSR-main-master1/DiffSR-main-master/trainers/base.py", line 236, in evaluate
    x_decoded = eval_loader.dataset.x_normalizer.decode(
  File "/home/yc/CVPR_26_fluid_SR/DiffSR-main-master1/DiffSR-main-master/utils/normalizer.py", line 34, in decode
    x = (x * std) + mean
RuntimeError: The size of tensor a (1024) must match the size of tensor b (4096) at non-singleton dimension 1
2025-10-07 08:39:37 - [INFO] - Process 0 finished.
